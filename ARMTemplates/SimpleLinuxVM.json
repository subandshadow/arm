{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
      "virtualMachines_azuretestvm1_name": {
          "defaultValue": "azuretestvm1",
          "type": "String"
      },
      "disks_azuretestvm1_OsDisk_1_9c03650fff254d3cb2f3da03cfcb82ec_externalid": {
          "defaultValue": "/subscriptions/904c28cc-7663-4aeb-94e7-e1b1156533d8/resourceGroups/hw-rg/providers/Microsoft.Compute/disks/azuretestvm1_OsDisk_1_9c03650fff254d3cb2f3da03cfcb82ec",
          "type": "String"
      },
      "networkInterfaces_azuretestvm1NetInt_externalid": {
          "defaultValue": "/subscriptions/904c28cc-7663-4aeb-94e7-e1b1156533d8/resourceGroups/hw-rg/providers/Microsoft.Network/networkInterfaces/azuretestvm1NetInt",
          "type": "String"
      }
  },
  "variables": {},
  "resources": [
      {
          "type": "Microsoft.Compute/virtualMachines",
          "apiVersion": "2023-03-01",
          "name": "[parameters('virtualMachines_azuretestvm1_name')]",
          "location": "eastus",
          "properties": {
              "hardwareProfile": {
                  "vmSize": "Standard_B1s"
              },
              "storageProfile": {
                  "imageReference": {
                      "publisher": "Canonical",
                      "offer": "0001-com-ubuntu-server-focal",
                      "sku": "20_04-lts-gen2",
                      "version": "latest"
                  },
                  "osDisk": {
                      "osType": "Linux",
                      "name": "[concat(parameters('virtualMachines_azuretestvm1_name'), '_OsDisk_1_9c03650fff254d3cb2f3da03cfcb82ec')]",
                      "createOption": "FromImage",
                      "caching": "ReadWrite",
                      "managedDisk": {
                          "storageAccountType": "Standard_LRS",
                          "id": "[parameters('disks_azuretestvm1_OsDisk_1_9c03650fff254d3cb2f3da03cfcb82ec_externalid')]"
                      },
                      "deleteOption": "Detach",
                      "diskSizeGB": 30
                  },
                  "dataDisks": [],
                  "diskControllerType": "SCSI"
              },
              "osProfile": {
                  "computerName": "[parameters('virtualMachines_azuretestvm1_name')]",
                  "adminUsername": "azureadmin3",
                  "linuxConfiguration": {
                      "disablePasswordAuthentication": false,
                      "provisionVMAgent": true,
                      "patchSettings": {
                          "patchMode": "ImageDefault",
                          "assessmentMode": "ImageDefault"
                      },
                      "enableVMAgentPlatformUpdates": false
                  },
                  "secrets": [],
                  "allowExtensionOperations": true,
                  "requireGuestProvisionSignal": true
              },
              "securityProfile": {
                  "uefiSettings": {
                      "secureBootEnabled": true,
                      "vTpmEnabled": true
                  },
                  "securityType": "TrustedLaunch"
              },
              "networkProfile": {
                  "networkInterfaces": [
                      {
                          "id": "[parameters('networkInterfaces_azuretestvm1NetInt_externalid')]"
                      }
                  ]
              }
          }
      }
  ]
}